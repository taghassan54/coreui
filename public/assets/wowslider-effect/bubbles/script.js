// bubbles
function ws_bubbles(h,A,q){function r(b){if("[object Array]"===Object.prototype.toString.call(b))return b[Math.floor(Math.random()*b.length)];var a,e=0,c;for(c in b)Math.random()<1/++e&&(a=c);return/linear|swing/g.test(a)?r(b):a}function w(b,a,e,c,f){b.clearRect(0,0,m,k);for(var d=0,h=e.length;d<h;d++){var g=Math.max(0,Math.min(1,a-e[d][3]*(1-a)));f&&u[f]&&(g=u[f](1,g,0,1,1,1));var l=m;1.8>=m/k&&.7<m/k?l*=2:.7>=m/k&&(l=2*k);var n=e[d][2]*g*l;c&&(n=(e[d][2]+(c[d][2]-e[d][2])*g)*l);n=Math.max(0,n);
b.beginPath();b.arc((e[d][0]+((c?c[d][0]:.5)-e[d][0])*g)*m,(e[d][1]+((c?c[d][1]:.5)-e[d][1])*g)*k,n,0,2*Math.PI,!1);b.fillStyle=p[d][0];b.fill()}}function B(b,a){a=a||{};var e=a.exclude||[],c,f=document.createElement("canvas"),d=f.getContext("2d");f.width=b.naturalWidth;f.height=b.naturalHeight;d.drawImage(b,0,0,b.naturalWidth,b.naturalHeight);try{c=d.getImageData(a.x?a.x:0,a.y?a.y:0,a.w?a.w:b.width,a.h?a.h:b.height).data}catch(m){return!1}for(var f=(a.w?a.w:b.width*a.h?a.h:b.height)||c.length,d=
{},g="",l=[],n="",k=0,h=0;h<f;){l[0]=c[h];l[1]=c[h+1];l[2]=c[h+2];g=l.join(",");d[g]=g in d?d[g]+1:1;if(-1===e.indexOf(["rgb(",g,")"].join(""))){var p=d[g];p>k&&(n=g,k=p)}h+=4}return["rgb(",n,")"].join("")}var t=jQuery,x=t(this),y=h.noCanvas||!document.createElement("canvas").getContext,m=h.width,k=h.height,C=t("<div>").css({position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden"}).addClass("ws_effect ws_bubbles").appendTo(q);if(!y)var z=t("<canvas>").css({position:"absolute",
left:0,top:0,width:"100%",height:"100%"}).appendTo(C),v=z.get(0).getContext("2d");var u={easeOutBack:function(b,a,e,c,f,d){void 0==d&&(d=1.70158);return c*((a=a/f-1)*a*((d+1)*a+d)+1)+e},easeOutBackCubic:function(b,a,e,c,f,d){b=(a/=f)*a;return e+c*(-1.5*b*a*b+2*b*b+4*b*a+-9*b+5.5*a)},easeOutCubic:function(b,a,e,c,f){return c*((a=a/f-1)*a*a+1)+e},easeOutExpo:function(b,a,e,c,f){return a==f?e+c:c*(-Math.pow(2,-10*a/f)+1)+e}},p=[["#bbbbbb",.5,.5],["#b3b3b3",.2,.2],["#b6b6b6",.5,.2],["#b9b9b9",.8,.2],
["#cccccc",.2,.8],["#c3c3c3",.5,.8],["#c6c6c6",.8,.8]],D=[[[.5,.5,.7,.15],[.5,.5,.6,.3],[.5,.5,.5,.45],[.5,.5,.4,.6],[.5,.5,.3,.75],[.5,.5,.2,.9],[.5,.5,.1,1]],[[.5,.5,.7,1],[.5,.5,.6,.9],[.5,.5,.5,.75],[.5,.5,.4,.6],[.5,.5,.3,.45],[.5,.5,.2,.3],[.5,.5,.1,.15]]],E=[[[.5,.5,0,1],[.5,.5,0,.9],[.5,.5,0,.75],[.5,.5,0,.6],[.5,.5,0,.45],[.5,.5,0,.3],[.5,.5,0,.15]],[[.5,.5,0,.15],[.5,.5,0,.3],[.5,.5,0,.45],[.5,.5,0,.6],[.5,.5,0,.75],[.5,.5,0,.9],[.5,.5,0,1]],[[.5,7.5,.7,.75],[.5,7.5,.6,.15],[.5,7.5,.5,1],
[.5,7.5,.4,.3],[.5,7.5,.3,.45],[.5,7.5,.2,.6],[.5,7.5,.1,.9]],[[.5,7.5,.7,1],[.5,7.5,.6,.9],[.5,7.5,.5,.75],[.5,7.5,.4,.6],[.5,7.5,.3,.45],[.5,7.5,.2,.3],[.5,7.5,.1,.15]]];this.go=function(b,a){if(y)q.find(".ws_list").css("transform","translate3d(0,0,0)").stop(!0).animate({left:b?-b+"00%":/Safari/.test(navigator.userAgent)?"0%":0},h.duration,"easeInOutExpo",function(){x.trigger("effectEnd")});else{m=q.width();k=q.height();z.attr({width:m,height:k});for(var e=A.get(a),c=0,f=p.length;c<f;c++){var d=
Math.abs(p[c][1]),t=Math.abs(p[c][2]);p[c][0]=B(e,{x:d*m,y:t*k,w:2,h:2})||p[c][0]}var g=r(D),l=r(E),n=r(u);wowAnimate(function(a){w(v,a,g,0,n)},0,1,h.duration/2,function(){q.find(".ws_list").css({left:b?-b+"00%":/Safari/.test(navigator.userAgent)?"0%":0});n=r(u);wowAnimate(function(a){w(v,1-a,l,g,n)},0,1,h.duration/2,function(){v.clearRect(0,0,m,k);x.trigger("effectEnd")})})}}};
